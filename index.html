<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Pok√©mon IFPR ‚Äî Pok√©dex</title>

<link href="https://fonts.googleapis.com/css2?family=Fredoka+One&family=Roboto:wght@400;700&display=swap" rel="stylesheet">

<style>
  :root{
    --bg-dark: #081017;
    --panel: rgba(255,255,255,0.06);
    --glass: rgba(255,255,255,0.06);
    --accent: #ff0000;
  }

  *{box-sizing:border-box}
  html,body{height:100%;margin:0;font-family:'Roboto',sans-serif;background:linear-gradient(180deg,#071421 0%, #0b2230 100%);color:#fff;-webkit-font-smoothing:antialiased}
  header{position:relative;padding:18px 20px 8px;text-align:center;z-index:30}
  .top-stripe{height:18px;background:#d00000}
  .top-black{height:18px;background:#000}
  .brand{display:flex;align-items:center;gap:18px;justify-content:center;margin-top:12px}
  .brand h1{font-family:'Fredoka One',cursive;font-size:24px;margin:0;color:#fff;text-shadow:0 4px 18px rgba(0,0,0,0.6)}

  /* Pokebola interactive */
  .pokebola-container{position:fixed;right:24px;top:22px;z-index:120;display:flex;align-items:center;justify-content:center}
  .pokebola{width:84px;height:84px;cursor:pointer;transition:transform .35s ease,filter .25s;display:block}
  .pokebola:hover{transform:rotate(10deg) scale(1.06)}
  .pokebola.evolving{animation:spin .5s linear}
  @keyframes spin{from{transform:rotate(0)}to{transform:rotate(360deg)}}

  /* Modal */
  .modal{position:fixed;inset:0;display:none;place-items:center;background:rgba(0,0,0,0.55);z-index:200}
  .modal.open{display:grid}
  .modal-card{width:340px;padding:20px;border-radius:14px;background:linear-gradient(180deg,rgba(255,255,255,0.06),rgba(255,255,255,0.03));backdrop-filter:blur(8px);border:2px solid rgba(255,255,255,0.12);text-align:center}
  .modal-card h3{margin:0 0 12px;font-family:'Fredoka One',cursive}
  .modal-card .modal-btn{display:block;width:80%;margin:10px auto;padding:10px 14px;border-radius:10px;border:none;background:#ff4b4b;color:#fff;font-weight:700;cursor:pointer}
  .modal-close{background:#666;margin-top:6px}

  /* Main content */
  main{position:relative;z-index:10;padding:28px 20px 60px;max-width:1200px;margin:0 auto}
  .hero{max-width:1100px;margin:6px auto 18px;text-align:center}
  .hero p{margin-top:6px;color:#d6eaf0;opacity:.9}

  /* Grid */
  #conteudo{display:grid;grid-template-columns:repeat(3,1fr);gap:26px;align-items:start;justify-items:center}
  @media (max-width:980px){#conteudo{grid-template-columns:repeat(2,1fr)}}
  @media (max-width:640px){#conteudo{grid-template-columns:1fr;padding:0 10px}}

  .card{
    width:320px;
    max-width:95%;
    padding:16px;
    border-radius:14px;
    background: linear-gradient(180deg, rgba(255,255,255,0.04), rgba(255,255,255,0.02));
    box-shadow: 0 6px 18px rgba(0,0,0,0.6);
    transition:transform .28s ease,box-shadow .28s;
    position:relative;
    overflow:visible;
    border:4px solid rgba(255,255,255,0.06);
  }
  .card:hover{transform:translateY(-8px) scale(1.02);box-shadow:0 18px 40px rgba(0,0,0,0.65)}

  .img-wrap{height:240px;display:flex;align-items:center;justify-content:center;padding:6px}
  .img-wrap img{max-width:220px;max-height:220px;object-fit:contain;filter:drop-shadow(0 6px 18px rgba(0,0,0,0.6));transition:transform .2s}
  .card:hover .img-wrap img{transform:scale(1.04)}

  .name{font-weight:800;font-size:1.25rem;margin-top:8px;text-align:center}
  .meta{display:flex;justify-content:center;gap:10px;margin-top:8px;flex-wrap:wrap}
  .type{padding:6px 10px;border-radius:12px;color:#fff;font-weight:700;font-size:.95rem;box-shadow:0 6px 18px rgba(0,0,0,0.4)}

  /* border color accent (applied inline from JS) */
  .desc{margin-top:8px;color:rgba(255,255,255,0.85);font-size:.95rem;text-align:center}

  /* loading & error */
  .loading{display:flex;align-items:center;gap:12px;justify-content:center;padding:40px;color:#cfeefc}
  .err{color:#ffb3b3;padding:18px;text-align:center}

  /* floating Cynthia GIF square (user asked) */
  .cynthia-float{position:fixed;bottom:28px;right:28px;width:260px;height:260px;border-radius:12px;z-index:110;pointer-events:none;overflow:hidden;box-shadow:0 10px 40px rgba(0,0,0,0.6)}
  .cynthia-float img{width:100%;height:100%;object-fit:cover;display:block;filter:contrast(1.02) saturate(1.05)}

  /* small credits/footer */
  footer{margin-top:28px;padding:18px;text-align:center;color:#bcdbe6;opacity:0.9}
</style>
</head>
<body>

  <!-- top stripes -->
  <div class="top-stripe"></div>
  <div class="top-black"></div>

  <!-- pokeball interactive -->
  <div class="pokebola-container" title="Clique: abrir / Duplo clique: evoluir">
    <img id="pokebola" class="pokebola" src="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/items/poke-ball.png" alt="Pok√©bola">
  </div>

  <header>
    <div class="brand">
      <h1>Pok√©mon IFPR</h1>
    </div>
  </header>

  <main>
    <section class="hero">
      <h2 style="font-family:'Fredoka One',cursive;margin:0">Escolha seu inicial</h2>
      <p>Lista carregada diretamente da planilha ‚Äî os cards abaixo exibem todos os Pok√©mons presentes na sua planilha.</p>
    </section>

    <div id="conteudo">
      <div class="loading" id="loading">
        <svg width="36" height="36" viewBox="0 0 24 24" fill="none"><path d="M12 2v4" stroke="#aee8ff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M20.49 7.51L17.66 10.34" stroke="#aee8ff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M22 12h-4" stroke="#aee8ff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M20.49 16.49L17.66 13.66" stroke="#aee8ff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M12 22v-4" stroke="#aee8ff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M3.51 16.49L6.34 13.66" stroke="#aee8ff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M2 12h4" stroke="#aee8ff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M3.51 7.51L6.34 10.34" stroke="#aee8ff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
        <div>Carregando pok√©mons da planilha...</div>
      </div>
    </div>

    <footer>
      ¬© 2025 Pok√©mon IFPR ‚Äî integrado √† sua planilha
    </footer>
  </main>

  <!-- floating Cynthia square GIF -->
  <div class="cynthia-float" aria-hidden="true">
    <img src="https://media1.tenor.com/m/BjI5K2TSw98AAAAd/cinthya-pokemon.gif" alt="">
  </div>

  <!-- modal (pokeball) -->
  <div class="modal" id="modal">
    <div class="modal-card" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
      <h3 id="modalTitle">Menu Pok√©bola</h3>
      <button class="modal-btn" data-action="pokedex">Pokedex Completa</button>
      <button class="modal-btn" data-action="regioes">Mapa de Regi√µes</button>
      <button class="modal-btn" data-action="pesquisados">Pok√©mons Pesquisados</button>
      <button class="modal-btn modal-close" id="modalClose">Fechar</button>
    </div>
  </div>

<script>
/*
  C√≥digo principal:
  - usa o SCRIPT_URL que voc√™ passou para buscar dados (JSON).
  - espera que cada item da planilha retorne chaves com nomes parecidos com:
    T√≠tulo / Url / Tipo / Descri√ß√£o  (caso os nomes forem diferentes, o mapeamento abaixo pode ser ajustado)
*/

const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbyLPSBXa7tcdenbYsvMGnCh32RkMqoKXbx7kevFKSbgp7cNEbqELukheNOjgJaUhPjj/exec";

const tiposMap = {
  fogo: {cor:"#EE8130",icone:"üî•"}, agua:{cor:"#6390F0",icone:"üíß"}, planta:{cor:"#7AC74C",icone:"üåø"},
  eletrico:{cor:"#F7D02C",icone:"‚ö°"}, psiquico:{cor:"#F95587",icone:"üîÆ"}, gelo:{cor:"#96D9D6",icone:"‚ùÑÔ∏è"},
  dragao:{cor:"#6F35FC",icone:"üêâ"}, noturno:{cor:"#705746",icone:"üåë"}, fada:{cor:"#D685AD",icone:"‚ú®"},
  lutador:{cor:"#C22E28",icone:"ü•ä"}, venenoso:{cor:"#A33EA1",icone:"‚ò†Ô∏è"}, terrestre:{cor:"#E2BF65",icone:"üåç"},
  pedra:{cor:"#B6A136",icone:"ü™®"}, fantasma:{cor:"#735797",icone:"üëª"}, inseto:{cor:"#A6B91A",icone:"üêõ"},
  aco:{cor:"#B7B7CE",icone:"‚öôÔ∏è"}, normal:{cor:"#A8A77A",icone:"‚ö™"}, voador:{cor:"#A98FF3",icone:"üå¨Ô∏è"}
};

const container = document.getElementById('conteudo');
const loading = document.getElementById('loading');

// Helper: normalize key names to be tolerant (T√≠tulo, Titulo, title, Name etc)
function pickField(item, possibleNames){
  for(const n of possibleNames){
    if(item[n] !== undefined) return item[n];
    const lower = n.toLowerCase();
    // try find case-insensitive
    for(const k of Object.keys(item)){
      if(k.toLowerCase() === lower) return item[k];
    }
  }
  return undefined;
}

function criarCard(item, index){
  // try to extract fields from sheet row
  const titulo = pickField(item, ['T√≠tulo','Titulo','title','nome','Nome']) || `Pok√©mon ${index+1}`;
  const url = pickField(item, ['Url','URL','Imagem','imagem','image','foto']) || '';
  const tipoRaw = pickField(item, ['Tipo','tipo','Types','types','Type']) || '';
  const descricao = pickField(item, ['Descri√ß√£o','Descricao','desc','description','bio']) || '';

  // create elements
  const card = document.createElement('article');
  card.className = 'card';

  // set border color by main type
  let mainType = '';
  if(typeof tipoRaw === 'string' && tipoRaw.trim().length){
    mainType = tipoRaw.split(/[\/,;|]/)[0].trim().toLowerCase();
  } else if(Array.isArray(tipoRaw) && tipoRaw.length) {
    mainType = (tipoRaw[0] || '').toString().trim().toLowerCase();
  }

  const cor = (tiposMap[mainType] && tiposMap[mainType].cor) ? tiposMap[mainType].cor : '#ffffff33';
  card.style.borderColor = cor;

  // image area
  const imgWrap = document.createElement('div');
  imgWrap.className = 'img-wrap';
  const img = document.createElement('img');
  img.alt = titulo;
  if(url && /^https?:\/\//i.test(url)){
    img.src = url;
  } else {
    // fallback: try using official sprite by name (lowercase) via pokeapi sprite (best effort)
    // but we avoid network errors ‚Äî leave a small placeholder
    img.src = `https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/other/official-artwork/25.png`;
  }
  imgWrap.appendChild(img);
  card.appendChild(imgWrap);

  // name
  const nameEl = document.createElement('div');
  nameEl.className = 'name';
  nameEl.textContent = titulo;
  card.appendChild(nameEl);

  // types
  const meta = document.createElement('div');
  meta.className = 'meta';
  const tipos = (typeof tipoRaw === 'string') ? tipoRaw.split(/[\/,;|]/).map(t=>t.trim()).filter(Boolean) : (Array.isArray(tipoRaw) ? tipoRaw : []);
  if(tipos.length === 0){
    // try to detect in other fields
    // leave blank
  }
  tipos.forEach(t=> {
    const tnorm = t.toLowerCase();
    const info = tiposMap[tnorm] || {cor:'#888',icone:''};
    const tEl = document.createElement('div');
    tEl.className = 'type';
    tEl.style.backgroundColor = info.cor;
    tEl.textContent = `${info.icone} ${t}`;
    meta.appendChild(tEl);
  });
  card.appendChild(meta);

  // description
  if(descricao){
    const desc = document.createElement('div');
    desc.className = 'desc';
    desc.textContent = descricao;
    card.appendChild(desc);
  }

  return card;
}

// fetch and render
async function carregarPlanilha(){
  loading.style.display = 'flex';
  try{
    const res = await fetch(SCRIPT_URL, {cache:'no-store'});
    if(!res.ok) throw new Error(`Erro rede: ${res.status}`);
    const dados = await res.json();

    // expecting array
    if(!Array.isArray(dados) || dados.length === 0){
      container.innerHTML = `<div class="err">A planilha retornou sem itens. Verifique o script ou compartilhe a planilha publicamente.</div>`;
      return;
    }

    // clear
    container.innerHTML = '';
    // For each item, create cards
    dados.forEach((item, idx) => {
      const card = criarCard(item, idx);
      container.appendChild(card);
    });
  } catch(err){
    console.error(err);
    container.innerHTML = `<div class="err">Erro ao carregar a planilha: ${err.message}</div>`;
  } finally {
    loading.style.display = 'none';
  }
}

// inicializa
carregarPlanilha();

/* ---------- Pok√©bola interactive + modal + evolu√ß√£o ---------- */
const pokebola = document.getElementById('pokebola');
const modal = document.getElementById('modal');
const modalClose = document.getElementById('modalClose');
const modalBtns = document.querySelectorAll('.modal-btn');

const pokebolas = [
  "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/items/poke-ball.png",
  "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/items/great-ball.png",
  "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/items/ultra-ball.png",
  "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/items/master-ball.png"
];
const brilho = ["#ff4b4b","#1E90FF","#FFD700","#C000FF"];
let indicePokebola = 0;

// single click opens modal
pokebola.addEventListener('click', (e) => {
  e.stopPropagation();
  modal.classList.add('open');
  pokebola.classList.add('pokebola-open');
});

// dblclick evolves to next
pokebola.addEventListener('dblclick', (e) => {
  e.stopPropagation();
  indicePokebola = (indicePokebola + 1) % pokebolas.length;
  pokebola.src = pokebolas[indicePokebola];
  // brief animation + glow
  pokebola.classList.add('evolving');
  pokebola.style.filter = `drop-shadow(0 0 18px ${brilho[indicePokebola]})`;
  setTimeout(()=> pokebola.classList.remove('evolving'), 450);
});

// modal controls
modalClose.addEventListener('click', ()=> {
  modal.classList.remove('open');
});
modal.addEventListener('click', (ev) => {
  if(ev.target === modal) modal.classList.remove('open');
});
modalBtns.forEach(b=>{
  b.addEventListener('click', (ev)=>{
    const action = ev.currentTarget.dataset.action;
    modal.classList.remove('open');
    // simple demos ‚Äî you can replace with real navigation
    if(action === 'pokedex') alert('Abrir Pokedex Completa (implemente a navega√ß√£o).');
    if(action === 'regioes') alert('Abrir Mapa de Regi√µes (implemente a navega√ß√£o).');
    if(action === 'pesquisados') alert('Abrir Pok√©mons Pesquisados (implemente a navega√ß√£o).');
  });
});

/* Theme toggle (small enhancement) */
const themeBtn = document.querySelector('.tema-toggle');
themeBtn?.addEventListener('click', ()=>{
  document.body.classList.toggle('tema-claro');
  document.body.classList.toggle('tema-escuro');
  themeBtn.textContent = document.body.classList.contains('tema-claro') ? 'üåô Dark Mode' : '‚òÄÔ∏è Light Mode';
});

</script>
</body>
</html>
