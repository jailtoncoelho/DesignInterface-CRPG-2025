<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Pok√©mon IFPR ‚Äî Pok√©dex</title>
  <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&family=Roboto:wght@400;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg1: linear-gradient(180deg,#071421 0%, #0b2230 100%);
      --glass: rgba(255,255,255,0.06);
      --accent: #d00000;
      --text: #ffffff;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:'Roboto',sans-serif;background:var(--bg1);color:var(--text);-webkit-font-smoothing:antialiased}
    /* --- top stripes (pok√©ball theme) --- */
    .top-stripe{height:20px;background:#d00000}
    .top-black{height:20px;background:#000}
    /* --- header --- */
    header{position:relative;padding:14px 16px 8px;text-align:center;z-index:30}
    .brand{display:flex;align-items:center;gap:12px;justify-content:center}
    .brand h1{font-family:'Fredoka One',cursive;font-size:26px;margin:0;color:var(--text);text-shadow:0 6px 18px rgba(0,0,0,.6)}
    /* --- pokeball (interactive) --- */
    .pokebola-container{position:fixed;right:22px;top:22px;z-index:220;width:92px;height:92px;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:transform .28s}
    .pokebola-container img{width:100%;height:100%;transition:transform .3s,filter .25s;filter:drop-shadow(0 8px 20px rgba(0,0,0,.6))}
    .pokebola-container:hover{transform:translateY(-4px)}
    .pokebola.evolving{animation:spin .5s linear}
    @keyframes spin{from{transform:rotate(0)}to{transform:rotate(360deg)}}

    /* --- main / layout --- */
    main{position:relative;z-index:50;max-width:1200px;margin:0 auto;padding:26px 18px 70px}
    .hero{text-align:center;margin-bottom:16px}
    .hero h2{font-family:'Fredoka One',cursive;margin:0 0 6px;font-size:20px}
    .hero p{margin:0;color:#cedfe8;opacity:.95}

    /* --- grid --- */
    #conteudo{display:grid;grid-template-columns:repeat(3,1fr);gap:24px;align-items:start;justify-items:center}
    @media(max-width:980px){#conteudo{grid-template-columns:repeat(2,1fr)}}
    @media(max-width:640px){#conteudo{grid-template-columns:1fr;padding:0 10px}}

    .card{width:320px;max-width:95%;padding:14px;border-radius:14px;background:linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));box-shadow:0 10px 30px rgba(0,0,0,.55);transition:transform .28s,box-shadow .28s;border:4px solid rgba(255,255,255,0.05)}
    .card:hover{transform:translateY(-8px) scale(1.02);box-shadow:0 20px 48px rgba(0,0,0,.7)}
    .img-wrap{height:240px;display:flex;align-items:center;justify-content:center;background:rgba(255,255,255,0.02);border-radius:10px;padding:6px}
    .img-wrap img{max-width:220px;max-height:220px;object-fit:contain;filter:drop-shadow(0 10px 26px rgba(0,0,0,.6));transition:transform .18s}
    .card:hover .img-wrap img{transform:scale(1.04)}
    .name{font-weight:800;font-size:1.22rem;text-align:center;margin-top:10px}
    .meta{display:flex;justify-content:center;gap:8px;flex-wrap:wrap;margin-top:8px}
    .type{padding:6px 10px;border-radius:12px;color:#fff;font-weight:700;font-size:.95rem;box-shadow:0 6px 18px rgba(0,0,0,.38)}
    .desc{margin-top:10px;font-size:.95rem;color:rgba(255,255,255,.9);text-align:center}

    /* loading/error */
    .loading{display:flex;align-items:center;justify-content:center;gap:12px;padding:40px;color:#bfe9ff}
    .err{color:#ffb3b3;padding:18px;text-align:center}

    /* --- Cynthia background (Option A) --- */
    .cynthia-bg{
      position:fixed;
      inset:0;
      z-index:10;
      pointer-events:none;
      display:block;
    }
    .cynthia-bg::before{
      content:"";
      position:absolute;
      inset:0;
      background: url("https://media1.tenor.com/m/BjI5K2TSw98AAAAd/cinthya-pokemon.gif") center top / cover no-repeat;
      filter:brightness(.45) blur(4px) saturate(.95);
      opacity:.95;
      transform:translateZ(0);
      z-index:11;
      mix-blend-mode:normal;
    }
    /* top overlay stripes should stay above bg */
    .top-overlay{position:relative;z-index:30}

    /* --- Modal (pok√©ball) --- */
    .modal{position:fixed;inset:0;display:none;place-items:center;background:rgba(0,0,0,.5);z-index:260}
    .modal.open{display:grid}
    .modal-card{width:360px;padding:18px;border-radius:14px;background:linear-gradient(180deg,rgba(255,255,255,0.06),rgba(255,255,255,0.03));backdrop-filter:blur(8px);border:2px solid rgba(255,255,255,0.12);text-align:center}
    .modal-card h3{margin:0 0 8px;font-family:'Fredoka One',cursive}
    .modal-btn{display:block;width:78%;margin:10px auto;padding:10px 14px;border-radius:10px;border:none;background:#ff5b5b;color:#fff;font-weight:700;cursor:pointer}
    .modal-close{background:#666;margin-top:6px}

    /* --- theme variants (classic vs elite) --- */
    /* default = classic */
    body.theme-classic{
      --bg1: linear-gradient(180deg,#071421 0%, #0b2230 100%);
      --accent: #d00000;
      --card-border: rgba(255,255,255,0.06);
    }
    /* elite (Cynthia-inspired) */
    body.theme-elite{
      --bg1: linear-gradient(180deg,#040306 0%, #0b070a 100%);
      --accent: linear-gradient(90deg,#ffbd4b,#ffd86b);
      --card-border: rgba(255,215,120,0.12);
    }
    /* accent helpers */
    .accent-strong { color:var(--accent); }
    /* small footer */
    footer{margin-top:28px;padding:18px;text-align:center;color:#bcdbe6;opacity:.9}
    /* theme toggle control */
    .theme-controls{position:fixed;left:22px;top:18px;z-index:230;display:flex;gap:8px}
    .theme-controls button{padding:8px 12px;border-radius:10px;border:none;background:rgba(255,255,255,0.06);color:#fff;cursor:pointer;font-weight:700}
    .theme-controls button.active{background:var(--accent);color:#000}
  </style>
</head>
<body class="theme-classic">

  <!-- Cynthia background (Option A) -->
  <div class="cynthia-bg" aria-hidden="true"></div>

  <!-- top stripes (above background)-->
  <div class="top-overlay">
    <div class="top-stripe"></div>
    <div class="top-black"></div>
  </div>

  <!-- Theme controls & pokeball -->
  <div class="theme-controls" aria-hidden="false">
    <button id="btnClassic" class="active">Classic</button>
    <button id="btnElite">Elite</button>
  </div>

  <div class="pokebola-container" title="Clique: abrir menu ¬∑ Duplo clique: evoluir">
    <img id="pokebola" src="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/items/poke-ball.png" alt="Pok√©bola">
  </div>

  <header>
    <div class="brand"><h1>Pok√©mon IFPR</h1></div>
  </header>

  <main>
    <section class="hero">
      <h2>Sua Pok√©dex</h2>
      <p>Os Pok√©mons s√£o carregados diretamente da sua planilha ‚Äî confira abaixo.</p>
    </section>

    <div id="conteudo">
      <div id="loading" class="loading">Carregando pok√©mons da planilha‚Ä¶</div>
    </div>

    <footer>¬© 2025 Pok√©mon IFPR</footer>
  </main>

  <!-- modal -->
  <div id="modal" class="modal" role="dialog" aria-modal="true">
    <div class="modal-card">
      <h3>Menu Pok√©bola</h3>
      <button class="modal-btn" data-action="pokedex">Pokedex completa</button>
      <button class="modal-btn" data-action="regioes">Mapa de regi√µes</button>
      <button class="modal-btn" data-action="pesquisados">Pok√©mons pesquisados</button>
      <button id="modalClose" class="modal-btn modal-close">Fechar</button>
    </div>
  </div>

<script>
/* ========== Config ========== */
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbyLPSBXa7tcdenbYsvMGnCh32RkMqoKXbx7kevFKSbgp7cNEbqELukheNOjgJaUhPjj/exec";

/* Tipo map (cores e √≠cones) */
const tiposMap = {
  fogo:{cor:"#EE8130",icone:"üî•"}, agua:{cor:"#6390F0",icone:"üíß"}, planta:{cor:"#7AC74C",icone:"üåø"},
  eletrico:{cor:"#F7D02C",icone:"‚ö°"}, psiquico:{cor:"#F95587",icone:"üîÆ"}, gelo:{cor:"#96D9D6",icone:"‚ùÑÔ∏è"},
  dragao:{cor:"#6F35FC",icone:"üêâ"}, noturno:{cor:"#705746",icone:"üåë"}, fada:{cor:"#D685AD",icone:"‚ú®"},
  lutador:{cor:"#C22E28",icone:"ü•ä"}, venenoso:{cor:"#A33EA1",icone:"‚ò†Ô∏è"}, terrestre:{cor:"#E2BF65",icone:"üåç"},
  pedra:{cor:"#B6A136",icone:"ü™®"}, fantasma:{cor:"#735797",icone:"üëª"}, inseto:{cor:"#A6B91A",icone:"üêõ"},
  aco:{cor:"#B7B7CE",icone:"‚öôÔ∏è"}, normal:{cor:"#A8A77A",icone:"‚ö™"}, voador:{cor:"#A98FF3",icone:"üå¨Ô∏è"}
};

/* DOM */
const container = document.getElementById('conteudo');
const loading = document.getElementById('loading');

/* helper to tolerate many header names */
function pick(item, names){
  for(const n of names){
    if(n in item) return item[n];
    const low = n.toLowerCase();
    for(const k in item){
      if(k.toLowerCase() === low) return item[k];
    }
  }
  return undefined;
}

/* create single card */
function createCard(row, idx){
  const title = pick(row, ['T√≠tulo','Titulo','nome','Nome','Name','Pokemon','Pok√©mon']) || `Pok√©mon ${idx+1}`;
  const url   = pick(row, ['Url','URL','Image','Imagem','Sprite','Foto','FotoUrl']) || '';
  const tipo  = pick(row, ['Tipo','tipo','Type','Types','Classe','Element']) || '';
  const desc  = pick(row, ['Descri√ß√£o','Descricao','Desc','Description','Bio','Notes']) || '';

  const card = document.createElement('article');
  card.className = 'card';

  let mainType = '';
  if(typeof tipo === 'string' && tipo.trim()) mainType = tipo.split(/[\/,;|]/)[0].trim().toLowerCase();
  const borderColor = (tiposMap[mainType] && tiposMap[mainType].cor) ? tiposMap[mainType].cor : 'rgba(255,255,255,0.06)';
  card.style.borderColor = borderColor;

  // image
  const imgWrap = document.createElement('div');
  imgWrap.className = 'img-wrap';
  const img = document.createElement('img');
  img.alt = title;
  if(url && /^https?:\/\//i.test(url)) img.src = url;
  else {
    // fallback: try to use PokeAPI official artwork by name (best-effort), else pokeball placeholder
    const nameForUrl = title.toString().toLowerCase().replace(/\s+/g,'-').replace(/[^a-z0-9\-]/g,'');
    // We avoid an expensive lookup; use placeholder sprite for safety
    img.src = 'https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/items/poke-ball.png';
  }
  imgWrap.appendChild(img);
  card.appendChild(imgWrap);

  // title
  const nameEl = document.createElement('div');
  nameEl.className = 'name';
  nameEl.textContent = title;
  card.appendChild(nameEl);

  // types
  if(tipo){
    const meta = document.createElement('div');
    meta.className = 'meta';
    const parts = (typeof tipo === 'string') ? tipo.split(/[\/,;|]/).map(t=>t.trim()).filter(Boolean) : (Array.isArray(tipo) ? tipo : []);
    parts.forEach(pt=>{
      const key = pt.toLowerCase();
      const info = tiposMap[key] || {cor:'#888',icone:''};
      const el = document.createElement('div');
      el.className = 'type';
      el.style.backgroundColor = info.cor;
      el.textContent = `${info.icone} ${pt}`;
      meta.appendChild(el);
    });
    card.appendChild(meta);
  }

  // description
  if(desc){
    const d = document.createElement('div');
    d.className = 'desc';
    d.textContent = desc;
    card.appendChild(d);
  }

  return card;
}

/* load sheet */
async function loadSheet(){
  loading.style.display = 'flex';
  try{
    const res = await fetch(SCRIPT_URL, {cache:'no-store'});
    if(!res.ok) throw new Error('Resposta com status '+res.status);
    const data = await res.json();
    if(!Array.isArray(data) || data.length === 0){
      container.innerHTML = '<div class="err">Planilha vazia ou formato inv√°lido. Verifique o script.</div>';
      return;
    }
    container.innerHTML = '';
    data.forEach((row, i)=> container.appendChild(createCard(row, i)));
  }catch(err){
    console.error(err);
    container.innerHTML = '<div class="err">Erro ao carregar a planilha: '+err.message+'</div>';
  }finally{
    loading.style.display = 'none';
  }
}
loadSheet();

/* ========== Pok√©bola interactive + modal + evolution ========== */
const pokebolaEl = document.getElementById('pokebola');
const modal = document.getElementById('modal');
const modalClose = document.getElementById('modalClose');
const modalBtns = document.querySelectorAll('.modal-btn');

const pokebolas = [
  "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/items/poke-ball.png",
  "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/items/great-ball.png",
  "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/items/ultra-ball.png",
  "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/items/master-ball.png"
];
const brilho = ["#ff4b4b","#1E90FF","#FFD700","#C000FF"];
let indicePokebola = 0;

// click = open modal
document.querySelector('.pokebola-container').addEventListener('click',(e)=>{
  // prevent dblclick fire from opening twice (dblclick also triggers click)
  if(e.detail === 1){
    setTimeout(()=>{
      if(e.detail === 1){
        modal.classList.add('open');
      }
    }, 160);
  }
});

// dblclick = evolve
document.querySelector('.pokebola-container').addEventListener('dblclick', (e)=>{
  indicePokebola = (indicePokebola + 1) % pokebolas.length;
  pokebolaEl.src = pokebolas[indicePokebola];
  pokebolaEl.style.filter = `drop-shadow(0 0 18px ${brilho[indicePokebola]})`;
  pokebolaEl.classList.add('evolving');
  setTimeout(()=> pokebolaEl.classList.remove('evolving'), 480);
});

// modal close handlers
document.addEventListener('click',(ev)=>{
  // close modal if click outside and modal open
  if(modal.classList.contains('open') && ev.target === modal) modal.classList.remove('open');
});
modalClose?.addEventListener('click', ()=> modal.classList.remove('open'));
modalBtns.forEach(b=>{
  b.addEventListener('click',(ev)=>{
    const act = ev.currentTarget.dataset.action;
    modal.classList.remove('open');
    if(act === 'pokedex') alert('Abrir Pokedex completa (implemente navega√ß√£o).');
    if(act === 'regioes') alert('Abrir mapa de regi√µes (implemente navega√ß√£o).');
    if(act === 'pesquisados') alert('Abrir Pok√©mons pesquisados (implemente navega√ß√£o).');
  });
});

/* ========== Theme switching (Classic / Elite) ========== */
const btnClassic = document.getElementById('btnClassic');
const btnElite = document.getElementById('btnElite');

function setTheme(theme){
  if(theme === 'classic'){
    document.body.classList.remove('theme-elite');
    document.body.classList.add('theme-classic');
    btnClassic.classList.add('active'); btnElite.classList.remove('active');
    // restore classic accents
    document.querySelectorAll('.card').forEach(c=> c.style.borderColor = c.style.borderColor || 'rgba(255,255,255,0.06)');
  } else {
    document.body.classList.remove('theme-classic');
    document.body.classList.add('theme-elite');
    btnElite.classList.add('active'); btnClassic.classList.remove('active');
    // gently tint card borders to gold-ish if not set by type
    document.querySelectorAll('.card').forEach(c=>{
      if(!c.style.borderColor || c.style.borderColor === 'rgba(255,255,255,0.06)') c.style.borderColor = 'rgba(255,215,120,0.12)';
    });
  }
}

btnClassic.addEventListener('click', ()=> setTheme('classic'));
btnElite.addEventListener('click', ()=> setTheme('elite'));

/* initial */
setTheme('classic');

</script>
</body>
</html>
